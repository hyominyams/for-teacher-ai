# PRD v2.0 — For Teacher AI

생활기록부 작성 도우미 웹앱

## 0. 문서 정보
- **제품명**: For Teacher AI
- **문서명**: Product Requirements Document
- **버전**: v2.0 (Refined)
- **기준일**: 2026-01-22 (Asia/Seoul)

---

## 1. 프로젝트 개요 및 배경
본 프로젝트는 교사의 생활기록부 작성 업무 효율을 극대화하기 위한 AI 기반 웹 서비스입니다. 반복적이고 소모적인 서술형 문장 작성 시간을 단축하고, 풍부한 표현을 제공하는 것을 목표로 합니다.

### 1.1 현재 진행 상황 (Status)
- [x] **Landing Page (`/`)**: 프리미엄 디자인(Scroll Expand Hero), 핵심 가치 전달 완료.
- [x] **Auth Logic (`/login`, `/signup`)**: Supabase Auth 연동 완료. 이메일/비밀번호 기반 인증 및 프로필(이름, 이메일, 학교) 자동 연동 구현 완료.
- [ ] **Chrome Extension 연동**: 웹앱의 로그인 세션을 익스텐션에서 공유하거나, API를 통해 동일한 데이터를 조회 가능한 구조 설계.

---

## 2. 목표 및 단계 정의
### 2.1 Phase 1 목표 (현재 범위)
- 30명 기준 생활기록부 작성 시간을 획기적으로 단축할 수 있는 작업 도구 제공.
- **행동특성 및 종합의견** 생성 기능 완전 구현.
- 생성된 결과의 저장, 편집, 복사 및 Excel 다운로드 기능 제공.

### 2.2 비목표 (Phase 1 범위 제외)
- 교과 세특 / 창체 / 업무 문서 실생성 기능 (UI만 노출).
- [x] **크롬 익스텐션 연동을 위한 데이터 구조 확보**: Supabase JWT 및 RLS를 활용하여 익스텐션에서도 안전하게 데이터 접근 가능하도록 설계.
- 크롬 익스텐션 개발 및 나이스 자동 입력 기능.
- 유료화 및 과거 버전 관리(History) 시스템.

---

## 3. 페이지별 요구사항

### 3.1 브랜드 랜딩 및 인증 (`/`, `/login`, `/signup`)
- **디자인 페이지 (`/`)**: 비로그인 사용자를 위한 설득형 랜딩. (완료)
- **인증 페이지**: 이메일/비밀번호 기반 가입/로그인. (완료 - 로직 연동 예정)

### 3.2 메인 대시보드 (`/app`)
- **목적**: 로그인 후 진입하는 기능 선택 허브.
- **Hero 섹션**: 랜딩보다 심플하게 구성, 페이지의 목적을 반영한 깔끔한 디자인
- **영역 선택**: 4가지 핵심 영역 카드 배치.
  - 행동특성 및 종합의견 (사용 가능)
  - 교과 세특 (Waiting)
  - 창의적 체험활동 (Waiting)
  - 업무 문서 (Waiting)
- **익스텐션 안내**: 최하단(Footer 위)에 **'나이스에 바로 붙여넣기'** 안내 섹션 배치 및 익스텐션 다운로드 링크 제공.

### 3.3 행동특성 작업 페이지 (`/app/behavior`)
- **UI 구조**: 좌측(입력/설정) 및 우측(결과 카드) 독립 스크롤 분할 레이아웃.

---

## 4. 행동특성 및 종합의견 페이지 기능 상세 요구사항 (FR)

### FR-1 학생 슬롯 생성 및 입력
- **학생 수 설정**: 1~40인 드롭다운 선택. 선택 시 슬롯 즉시 동적 생성.
- **슬롯 구성**: 
  - 체크박스 (선택 생성용)
  - 번호 (슬롯 위치값)
  - 키워드 태그 입력 (엔터로 추가, 최소 2개 필수)
  - **🎲 자동 생성**: 클릭 시 미리 정의된 키워드 풀에서 랜덤 2개 삽입 (중복 방지).
- **슬롯 스왑**: 번호 변경 UI를 통해 특정 번호와 현재 번호의 데이터(키워드/결과)를 맞교환.

### FR-2 생성 옵션 및 실행
- **옵션**: 글자수 제한 (100 / 200 / 300자) 라디오 버튼.
- **버튼**: '전체 학생 생성' 및 '선택 학생 생성'.
- **동작**: 슬롯 단위 개별 API 호출. 진행 상태(`생성 중... i/N`) 표시.
- **예외**: 실패한 슬롯은 에러 메시지와 함께 '재생성' 버튼 노출.

### FR-3 결과 편집 및 관리
- **결과 카드**: 번호, 텍스트 영역(textarea), 실시간 글자수 카운트 표시.
- **액션**: 
  - **복사**: 클릭 시 클립보드 복사 및 토스트 알림.
  - **수정**: 수동 편집 시에도 상태 유지.
  - **재생성**: 기존 키워드 유지하며 결과만 갱신.

### FR-4 최종본 저장 및 다운로드
- **저장 (Save)**: `behavior` 카테고리로 데이터베이스에 Upsert. JSONB 구조 유지.
- **엑셀 (Excel)**: `번호 | 행동특성 및 종합의견` 컬럼 구성으로 파일 다운로드. 결과가 없는 슬롯도 번호 순서(1..N) 유지.

---

## 5. 기술 및 데이터 설계

### 5.1 데이터베이스 (`saved_results` 테이블)
- `user_id`: 사용자 식별자 (RLS 적용)
- `category`: "behavior" 등 카테고리 구분
- `data`: 아래의 JSONB 구조 저장
  ```json
  {
    "students": [
      { "number": 1, "keywords": ["성실", "리더십"], "result": "..." },
      { "number": 2, "keywords": [], "result": null }
    ],
    "options": { "charLimit": 200 },
    "metadata": { "totalStudents": 30, "savedAt": "..." }
  }
  ```

### 5.2 API 가이드
- `POST /api/generate`: 프롬프트 전달형 텍스트 생성 API.
- `POST /api/results`: 사용자별/카테고리별 데이터 Upsert.
- `GET /api/results`: 저장된 데이터 조회.

---

## 6. 핵심 설계 원칙
1. **데이터 최소화**: 학생의 실명은 저장하지 않으며 '번호'로만 식별한다.
2. **도구적 성격**: 작업 페이지는 화려함보다 가독성과 사용 속도에 집중한다.
3. **확장성**: 향후 교과세특 등 타 카테고리 확장이 용이하도록 스키마를 고정한다.

trigger: model_decision